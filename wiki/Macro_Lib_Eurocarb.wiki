  
= Eurocarb.lib.ftl =

A library of generic Freemarker text macros for generating HTML interfaces
for the Eurocarb project.

<wiki:toc>

To use this library in templates, use the following line:
{{{    
    <#import "/template/lib/Eurocarb.lib.ftl" as ecdb />
}}}
assuming that this file is located at `$WEBAPPLICATION_ROOT/template/lib`. 

*Note* that this macro lib is included by default when using the standard 
Eurocarbdb header include.

*Note* also that when included in Eurocarbdb templates, you need the `text` 
prefix in the macro, ie: a macro used here as `<@repeat ...` will be used in 
Eurocarbdb templates as `<@text.repeat ...`.

Authors:

mjh, ac, hirenj, mc

This page auto-generated from source with Perl:
{{{
    cat application/Eurocarbdb/src/template/lib/TextUtils.lib.ftl | perl -e 'BEGIN { undef $/ } $text = <>; while ($text =~ /<\#-+(.+?)-+>/gs) { print $1; }' 
}}}

----

== Macros ==

=== macro: actionlink ===

Main macro for creating links to other action urls.

NOTE: this macro works, but you can always get away with using 
'${base}/action_name.action' and '${base}/my_namespace/action_name.action' 
and it will resolve the namespaces correctly.

Args:
    
    # name    - the name of the action, *without* the '.action' at the end.
    # ns      - optional - the namespace of the desired action, with or without a leading '/'. defaults to current namespace.
    # params  - optional - any/all CGI params to append to action URL.
    
Any number of additional arguments may be supplied - these are added into the URL 
without modification.    
    
Examples:
{{{
    given  : '<@ecdb.actionlink name="xxx">example1</@>' 
    returns: '<a href="xxx.action">example1</a>'
    
    given  : '<@ecdb.actionlink name="xxx" ns="/" params="" >example2</@>'
    returns: '<a href="/[base-url]/xxx.action">example2</a>'
    
    given  : '<@ecdb.actionlink name="xxx" ns="gwb" params="" >example3</@>'
    returns: '<a href="/[base-url]/gwb/xxx.action">example3</a>'
    
    given  : '<@ecdb.actionlink name="xxx" ns="/gpf" params="" >example4</@>'
    returns: '<a href="/[base-url]/gpf/xxx.action">example4</a>'
    
    given  : '<@ecdb.actionlink name="xxx" ns="/gpf" params="abc=1;cde=2" >example5</@>'
    returns: '<a href="/[base-url]/gpf/xxx.action?abc=1;cde=2">example5</a>'
    
    given  : '<@ecdb.actionlink name="xxx" ns="/gpf" params="abc=1;cde=2" onclick="some_js" >example6</@>'
    returns: '<a href="/[base-url]/gpf/xxx.action?abc=1;cde=2" onclick="some_js">example6</a>'
}}}
    

=== macro: context_box ===

Creates a context box widget. The HTML generated looks like this:
{{{
    <div id="your_optional_id" class="context_box">
        <h3>Title, if given</h3>
        [your content here]
    </div>
}}}
Usage:
{{{
    <@ecdb.context_box title="Page Title"> 
        [your content here]
    </@>
}}}    
Args:

    # id          - optional string - DOM id of the HTML div
    # title       - optional string - title text for this box
    # prepend     - optional boolean - if true, content is prepended instead of appended.
    
Note that this macro only adds a widget to the current widget buffer variable
`context_menu` -- the actual HTML is placed in pages with the macro `context_menu_inline`,
found below.
    
 
=== macro: context_menu_inline ===
Just prints the contents of ${context_menu}. Don't use. 
 

=== macro: datepicker ===

Renders a date picker widget.

Args:
    # label
    # name
    # value

(more info here pls)
    

=== macro: sugar_notation_widget ===

Adds a sugar notation widget box thingy as a context box 
(see context_box macro).

Usage:
{{{
    <@sugar_notation_widget />
}}}

 
=== macro: create_issue_link ===

Renders a link to auto-create a new issue on eurocarb googlecode issue tracker.

Args:
    # summary 
        optional. the 1-line summary/title of issue to create. 
        defaults to the default for the template selected.
    # text  
        optional. link text (ie: between the `<a href >...</a>`). 
        defaults to `"submit a new bug/issue"`.
    # exception 
        optional. an exception, if any. if present, a stack trace will be included
    # issue_template 
        optional. the googlecode issue template to use. 
        defaults to `"Defect report from user"`
    # status 
        optional. the initial issue status, defaults to 'New'.
    # target
        optional. href target. defaults to `"_blank"`.
    # ...   
        any number of additional attributes can be given and these will be inlined
        into the link, eg: `title="href title" onclick="..."`
        
Any text between `<@create_issue_link ...></@>` tags will be included
in the body of the issue page. Make sure this text is not too long, 
no more than 1000 or so characters.

Examples:
    
    # using mainly defaults
{{{
    <@create_issue_link 
        text="report a scientific issue"
        issue_template="Scientific issue" 
        target="_blank" />       
}}}
    
    # creating a link in response to an exception
{{{
    <@create_issue_link 
        summary=exception.message 
        text="report this exception"
        exception=exception />
}}}


=== macro: header ===

Usage:

    <@eurocarb.header title="Page Title" /> 

Args:

    # title       - HTML page title

Produces HTML header text. 


=== macro: footer ===

Usage:
{{{
    <@eurocarb.footer/> 
}}}
Args:

    # title       - HTML page title

Produces HTML footer text. 


=== macro: detail_link ===

Usage:
{{{
    <@eurocarb.detail_link object=some_object /> 
    <@eurocarb.detail_link object=some_object>${text}</@eurocarb.detail_link>
}}}    
Args:
    # object      - An object that implements the `EurocarbObject` interface.
    # text        - The displayed text for the link. Default = `object.getName()`.

Produces a link to a "show detail" page for the given object

Any other attributes (`target="..." onclick="..."`) are rendered as given.    
    

=== macro: use_js_lib ===

Usage: 
{{{
    <@use_js_lib name=[Library name] /> 
}}}

Macro to include ECDB libraries. All dependencies for the libraries
are globally controlled in the template that defines the ecdbjs macro 
(see: `Eurocarb.js.lib.ftl`)

Any libraries with names prefixed with `XYZ::` or something similar, are 
wholly external libraries, and do not include any local libraries.

Any CSS and JS files associated with the libraries are retrieved.


=== macro: contributor ===

Usage:
{{{
    <@contributor c=[Contributor object] /> 
    <@contributor c=[Contributor object] text="[some custom text here]" /> 
}}}

Renders contributor detail text with hyperlink.


=== macro: taxonomy ===

Usage: 
{{{    
    <@taxonomy t=[Taxonomy object] />
    <@taxonomy t=[Taxonomy object] text="[some custom text here]" />
}}}

Displays taxonomy detail text with hyperlinks.


=== macro: tissue ===

Usage: 
{{{
    <@tissue t=[TissueTaxonomy object] />
}}}

Display tissue detail text with hyperlinks


=== macro: disease ===

Usage:
{{{
    <@disease d=[Disease object] />
}}}

Display disesase detail text with hyperlinks.


=== macro: perturbation ===

Usage: 
{{{
    <@perturbation p=[Perturbation object] />
}}}

Display disease detail text with hyperlinks


=== macro: perturbation ===

Usage: 
{{{
    <@perturbation p=[Perturbation object] />
}}}

Display disease detail text with hyperlinks


=== macro: short_glycan_sequence_context ===

Usage: 
{{{
    <@short_glycan_sequence_context context=[GlycanSequenceContext object] />
}}}

Renders a brief text description of a GlycanSequenceContext, with links.


=== macro: short_scan ===

Usage: 
{{{
    <@short_scan scan=[Scan object] />
}}}

Renders a brief text description of a Scan, with links.


=== macro: biological_context ===

Usage: 
{{{
    <@biological_context bc=[BiologicalContext object] />
    <@biological_context bc=[BiologicalContext object] separator=[String] />
}}}
    
Display a detail link for a biological context with embedded links 
for its component Taxonomy and TissueTaxonomy, as well as any other
associated info. By default, this text spans multiple lines, unless
an alternate `separator` argument is given.

 
=== macro: bc_disease_names ===

Usage: 
{{{
    <@bc_disease_names bc=[BiologicalContext object] />
}}}
    
Renders a list of disease detail links for the Diseases of 
a given BiologicalContext.


=== macro: bc_perturbations ===

Usage: 
{{{
    <@bc_perturbations bc=[BiologicalContext object] />
}}}
    
Renders a list of disease detail links for the Perturbations of 
a given BiologicalContext.


=== macro: biological_context ===

Usage: 
{{{
    <@biological_context bc=[BiologicalContext object] />
    <@biological_context bc=[BiologicalContext object] separator=[String] />
}}}
    
Display a brief description of a biological context with embedded links 
for its component Taxonomy and TissueTaxonomy, as well as any other
associated info. Single line by default.

 
=== macro: sugar_image ===

Usage: 
{{{
    <@sugar_image id=[GlycanSequence id] scale=[scale factor, default=1] output=[image type, default='png']/>
}}}

Renders a sugar image (ie: `<img src="..." />`) for the given GlycanSequence id.
'scale' argument should be between 0-1.0 inclusive.

Only the 'id' argument is required.


=== macro: sugar_image_for_seq ===

Usage: 
{{{
    <@sugar_image seq=[a glycan sequence string] format=[seq format, default='gws'] scale=[scale factor, default=1] output=[image type, default='png']/>
}}}

Renders a sugar image (ie: `<img src="..." />`) for the given sequence and format.
`scale` argument should be between 0-1.0 inclusive.

only the `seq` argument is required. Note that you will probably have to URL-escape 
the sequence, ie: `your_seq?url`


=== macro: linked_sugar_image ===

Usage: 
{{{
    <@linked_sugar_image id=[GlycanSequence id] scale=[scale factor]/>
}}}

Renders a hyperlinked sugar image (ie: `<a href="..."><img src="..." /></a>`)
for the given GlycanSequence id.

`scale` argument should be between 0-1.0 inclusive.

=== macro: experiment ===

Usage: 
{{{
    <@experiment e=[Experiment] />
}}}

Renders a experiment detail hyperlink.


=== macro: evidence ===

Usage: 
{{{
    <@evidence ev=[Evidence] />
}}}

Renders an evidence detail hyperlink.

=== macro: experiment_step ===

Usage: 
{{{
    <@experiment_step object=[ExperimentStep] />
}}}

Renders a experiment step detail hyperlink

=== macro: reference ===

Usage: 
{{{
    <@reference ref=[Reference object] />
}}}

displays summary information for a reference


    
=== macro: reference_brief ===

Usage: 
{{{
    <@reference_brief object=[Reference] />
}}}

Renders a brief reference link.

=== macro: addGu ===

Usage: 
{{{
    <@addGu ref=[Reference object] />
}}}

display a summary information for a reference for adding gu data.

=== macro: page_navigator ===

Usage: 
{{{
    <@page_navigator action_name=[string] />
}}}

Display a simple page, with links to change page in a pageable action.