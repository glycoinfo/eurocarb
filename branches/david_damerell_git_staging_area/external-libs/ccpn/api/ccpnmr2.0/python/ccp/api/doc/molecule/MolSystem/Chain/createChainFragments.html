
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<!--Generated by PyApiDocGen on Mon Apr  6 17:01:33 2009-->
<!--======================COPYRIGHT/LICENSE START==========================

index.html: Python API documentation for CCPN data model, package ccp.molecule.MolSystem

Copyright (C) 2007  (CCPN Project)

=======================================================================
The license for this file is in ../../../../../../../..license/LGPL.license
======================COPYRIGHT/LICENSE END============================

for further information, please contact :

- CCPN website (http://www.ccpn.ac.uk/)

- email: ccpn@bioc.cam.ac.uk

=======================================================================
===========================REFERENCE START=============================
===========================REFERENCE END===============================
-->
<HTML>
<head>
  <title>CCPN Python API Method: ccp.api.molecule.MolSystem.Chain.createChainFragments</title>
  <link rel=stylesheet type="text/css" href="../../../../../../../doc/htmldoc.css">
  <script language="JavaScript">
    function wopn(href){ window.open(href,'','width=880,height=500,top=300,left=300,resizable=0,toolbar=0,location=0,directories=0,status=0,menubar=0,scrollbars=1')}
  </script>
</head>
<body>
<table bgcolor="#F0CC99" border="0" height="100" width="100%">
  <tr>
    <td>
      <a href="http://www.ccpn.ac.uk/" class="mainlogo"><img  alt="CCPN" border="0" id="toplink" src="../../../../../../../doc/graphics/CCPN_Logo_200_x.gif"/></a>
      <br>
      &nbsp;&nbsp;&nbsp;
      Data Model version 2.0.b2
    </td>
    <td valign="center" width="80%">
      <!-- TOP BANNER BEGIN-->
      <div class="topbanner">
        <table border="0" width="100%">
          <tr valign="top">
            <td align="right" width="80%">
              <a href="javascript:wopn('../../../../../../../doc/acknowledgements.html')">Acknowledgements</a>
            </td>
          </tr>
          <tr>
            <td align="center">
              <a href="../../../../../../../model/doc/ccp/molecule/MolSystem.html">Diagram</a>
              |
              <a href="../../../../../../../python/doc/classMap.html">Class Map</a>
              |
              <a href="../../../../../../../python/doc/attributeMap.html">Attribute Map</a>
              |
              <a href="../../../../../../../python/doc/methodMap.html">Method Map</a>
              |
              <a href="javascript:wopn('../../../../../../../doc/help.html')">Help</a>
              |
              <a href="javascript:wopn('../../../../../../../doc/license.html')">License</a>
            </td>
          </tr>
          <tr valign="top">
            <td align="center" valign="bottom">
              <a href="../../../../../../../python/doc/api.html">Home</a>
              |
              <a href="../../../../../../../python/ccp/api/doc/molecule/MolSystem/index.html">Package</a>
              |
              <a href="../../../../../../../python/ccp/api/doc/molecule/MolSystem/Chain/index.html">Class</a>
              |
              Attribute
              |
              <span class="underover">
              Method:
              </span>
              {
              prev
              |
              <a href="../../../../../../../python/ccp/api/doc/molecule/MolSystem/Chain/getEmpiricalFormula.html">next</a>
              }
            </td>
          </tr>
          <tr>
            <td>
            </td>
          </tr>
        </table>
      </div>
      <!-- TOP BANNER END-->
    </td>
  </tr>
</table>
<table cellpadding="5" width="100%">
  <tr>
    <td>
      <h2>Method: createChainFragments</h2>
      <ul>
      <h3>from Class <a href="index.html">ccp.api.molecule.MolSystem.Chain</a></h3>
      </ul>
      <br>
      <ul>
      Creates ChainFragments for all Residues that do not already have them, while making no modification to existing ChainFragments or their contents. Is called automatically on Chain creation. Any program that modifies the automatically created ChainFragments should call this function at the end, to ensure that every Residue belongs to a&nbsp;&nbsp;ChainFragment. <br>
      <br>
      The function&nbsp;&nbsp;divides the residues in four molTypes: protein, carbohydrate, DNA/RNA ,and other. Within each molType, stretches of linear polymer of two or more residues are identified without regard to the seqId value of the residues. These are put in separate ChainFragments, with the residues ordered by sequence rather than seqID. Subsequently,&nbsp;&nbsp;residues not part of a linear polymer are grouped in the largest directly connected fragments of uniform molType. Finally, for fragments of type DNA/RNA the molType is set to DNA or RNA if this is the only molType that happens to be present, to DNA/RNA otherwise.
      </ul>
      <br>
      <table cellpadding="2" cellspacing="2">
        <tr>
          <td>
            guid:
          </td>
          <td>
            www.ccpn.ac.uk_Fogh_2006-08-16-18:23:32_00020
          </td>
        </tr>
        <tr>
          <td>
            OpType:
          </td>
          <td>
            other
          </td>
        </tr>
        <tr>
          <td>
            OpSubType:
          </td>
          <td>
            None
          </td>
        </tr>
        <tr>
          <td>
            isQuery:
          </td>
          <td>
            False
          </td>
        </tr>
        <tr>
          <td>
            isAbstract:
          </td>
          <td>
            False
          </td>
        </tr>
        <tr>
          <td>
            Scope:
          </td>
          <td>
            instance_level
          </td>
        </tr>
        <tr>
          <td valign="top">
            Code:
          </td>
          <td valign="top">
            # global set up<br>
            dnarna = 'DNA/RNA'<br>
            topdict = {'protein':{},&nbsp;&nbsp;'carbohydrate':{}, 'other':{}, dnarna:{}}<br>
            linearTags = ('prev', 'next')<br>
            <br>
            #partition residues by molType<br>
            for molres in self.molecule.molResidues:<br>
            &nbsp;&nbsp;res = self.findFirstResidue(seqId=molres.serial)<br>
            &nbsp;&nbsp;if res is not None and not res.chainFragment:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;molType = molres.molType<br>
            &nbsp;&nbsp;&nbsp;&nbsp;dd = topdict.get(molType)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;if dd is None:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dd = topdict['other']<br>
            &nbsp;&nbsp;&nbsp;&nbsp;dd[molres] = res<br>
            <br>
            # analyse link graph and make ChainFragments<br>
            for (molType, dd) in topdict.items():<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;if molType == 'carbohydrate':<br>
            &nbsp;&nbsp;&nbsp;&nbsp;dd2 = dd<br>
            <br>
            &nbsp;&nbsp;else:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;# make linear polymer fragments<br>
            &nbsp;&nbsp;&nbsp;&nbsp;dd2 = {}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;while dd:<br>
            &nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# set up<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(molres, res0) = dd.popitem()<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res = res0<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mr = molres<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;residues = [res]<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(tag1, tag2) = linearTags<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstTime = True<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while True:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# find linear polymer linked molResidue, and add residue to residues list<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;linkEnd = mr.findFirstMolResLinkEnd(linkCode=tag1)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if linkEnd:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ml = linkEnd.molResLink<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ml:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(le, le2) = ml.molResLinkEnds<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if le is linkEnd:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;le = le2<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if le.linkCode == tag2:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mr = le.molResidue<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res = dd.get(mr)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if res is not None:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;del dd[mr]<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;residues.append(res)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continue<br>
             <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# If we get here, we have reached the end of the polymer chain<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if firstTime:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# now start again at molres, going in opposite direction<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;firstTime = False<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(tag1, tag2) = (tag2, tag1)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;residues.reverse()<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mr = molres<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# both ends done, finalise<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if len(residues) &lt; 2:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# no linear polymer found - put molres in new dictionary<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dd2[molres] = res0<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if molType == dnarna:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mt = residues[0].molType<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for rr in residues[1:]:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if rr.molType != mt:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mt = 'DNA/RNA'<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mt = molType<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ChainFragment(<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; self, molType=mt, isLinearPolymer=True, residues=residues<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br>
            &nbsp;&nbsp;<br>
            &nbsp;&nbsp;# make fragments that are not linear polyumers<br>
            &nbsp;&nbsp;while dd2:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;# set up<br>
            &nbsp;&nbsp;&nbsp;&nbsp;(molres, res) = dd2.popitem()<br>
            &nbsp;&nbsp;&nbsp;&nbsp;mrs = [molres]<br>
            &nbsp;&nbsp;&nbsp;&nbsp;residues = [res]<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;for molres in mrs:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for linkEnd in molres.molResLinkEnds:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ml = linkEnd.molResLink<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ml:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(le, le2) = ml.molResLinkEnds<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if le is linkEnd:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;le = le2<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mr = le.molResidue<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res = dd2.get(mr)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if res is not None:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;del dd2[mr]<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mrs.append(mr)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;residues.append(res)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;if molType == dnarna:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mt = residues[0].molType<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for rr in residues[1:]:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if rr.molType != mt:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mt = 'DNA/RNA'<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break<br>
            &nbsp;&nbsp;&nbsp;&nbsp;else:<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mt = molType<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
            &nbsp;&nbsp;&nbsp;&nbsp;ChainFragment(<br>
            &nbsp;&nbsp;&nbsp;&nbsp; self,molType=mt, isLinearPolymer=False, residues=residues<br>
            &nbsp;&nbsp;&nbsp;&nbsp;)
          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>


<table width="100%" cellpadding=2>
  <tr><td colspan=2 width="100%" bgcolor=#794E83></td></tr>
  <tr>
    <td><h5>
    
      &nbsp;
    <em>Data Model Version</em>&nbsp;2.0.b2
    </h5></td>
    <td align=right><a href='#toplink'><span style="font-size:9pt">Go&nbsp;to&nbsp;Top&nbsp;&nbsp;</span></a>
    </td>
  </tr>
</table>

<div class="leftbanner">
<table width=100% cellspacing=0 cellpadding=2 border=0>
  <tr><td bgcolor=#794E83>
    <nobr>
    <em>&nbsp;&nbsp;Autogenerated by</em>&nbsp;&nbsp;PyApiDocGen&nbsp;
    <em>revision</em>&nbsp;1.3&nbsp;&nbsp;
    <em>on</em>&nbsp;&nbsp;Mon Apr  6 17:01:33 2009&nbsp;</nobr>
    <nobr>&nbsp;
    <em>from data model package</em>&nbsp;&nbsp;ccp.api.molecule.MolSystem.Chain&nbsp;&nbsp;
    <em>revision</em>&nbsp;1.45.2.9&nbsp;&nbsp;</nobr>
  </td></tr>
</table>
</div>
<table width=100% cellspacing=0 cellpadding=2 border=0>
  <tr valign=top>
    <td><h6>&nbsp;&nbsp;Work done by the <a href="mailto:ccpn-dev@mole.bio.cam.ac.uk">CCPN team</a>.</h6></td>
    <td align=right><h6><a target="blank" href="http://www.ccpn.ac.uk">www.ccpn.ac.uk</a>&nbsp;&nbsp;</h6></td>
  </tr>
</table>
<br>

</body>
</HTML>
